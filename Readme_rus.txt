Модуль распознавания капч Turbobit, дальнейшее развитие проекта ocrimg.
Распознавание сделано на основе Tesseract 5, обработка изображений - Python 3.4 32 bit, что позволяет использовать её на 32- и 64-битных системах, начиная с Windows XP.
(компиляция в pyinstaller позволяет запускать программу на машине без установленного Python)
Надежность распознавания около 70 - 80% за счет обработки исходного изображения в OpenCV.

На компьютере должна быть папка с программой распознавания Tesseract версии 5. Путь к ней прописывается в файле focr.ini в секции Tesseract.
Если Tesseract у Вас уже установлен, поместите файл 'turbobit' в папку \Tesseract\tessdata\configs\

Файл turbobit_net_v50_GDL_03.png включен для проверки, просто запустите ocrimg и примерно через 15 секунд в папке, указанной в файле ocrimg.ini в секции Output появится текстовый файл с распознанной капчей.

В файл captchas.lua добавлен вызов программы обработки и распознавания ocrimg, результат помещается в файл rezocr.txt и автоматически подхватывается USD.
В данной версии ocrimg - модуль запуска, передающий в focr путь к распознаваемому файлу и путь к файлу результата.

Для подключения к USD просто поместите файлы ocrimg.exe и ocrimg.ini в его папку, файл captchas.lua в папку USDownloader\lua или отредактируйте находящийся там файл, добавив в него строки для вызова программы распознавания:

Captchas['turbobit_net_kohana'] = {
    ocrCmd = usd.workdir .. [[ocrimg.exe]]  
    , result = usd.workdir .. [[rezocr.txt]]
    , timeout = 50
    , sw = SW_HIDE
    , tryManual = true
}

tryManual = true для вывода окна ввода капчи, если ничего не вводить - запустится программа распознавания.
Чтобы распознавание запускалось сразу, исправьте на tryManual = false

Настройки в файле focr.ini:

[Tesseract]
dir = C:\Tesseract\ Путь к папке с Tesseract
opt = --psm 10 turbobit Опции распознавания

[Image]
mask = 11000000 Маска, по которой обрезаются младшие биты цвета. В данной версии не используется.
save_img = 0 Сохранять файлы с капчей
save_parts = 0 Сохранять файлы с распознаваемыми символами
save_dir = .\Images\ Путь для сохранения файлов. Если папка не существует, она будет создана

[Parts] Границы, по которым капча разбивается на символы
0 : 43
35 : 75
70 : 107
102 : 148

[Angle]
start = -24 Начальный угол поворота изображения с символом. Уменьшен, т.к. большого поворота влево нет.
finish = 42 Конечный угол поворота
step = 6 Шаг поворота. Оптимальные значения 3, 4, 5, 6

[Changes] Замена символов, которые определились "двойками". Как правило, такое происходит если символ при распознавании повернут на большой угол

[Koeff] Весовые коэффициенты отдельных символов

[Break]
limit = 7 Максимальное число одинаковых символов в массиве, по достижении которого распознавание символа прекращается. Позволяет немного увеличить скорость, не сильно снижая точность распознавания. Для отключения поставьте 0

[Output] Сохранение результата
mode = file Сохранение в файл (по умолчанию)
Возможные значения: clipboard - Сохранение в буфер обмена, print - Вывод на экран (в командных файлах), stdout - Возврат вызвавшей программе (в командных файлах)

filename = C:\USDownloader\rezocr.txt Путь к файлу с результатом в режиме file. При сохранении в папку с программой можно указать только имя файла.
При использовании focr в связке с ocrimg путь к сохраняемому файлу результата передается в строке запуска программы, данная настройка игнорируется.
